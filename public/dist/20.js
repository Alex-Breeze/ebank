webpackJsonp([20],{359:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{list:[],merchant:"",order_type:"",purse_type:"",user_type:"",payment:"",payments:"",amount_sum:"",keyword:{page:1,export:0,user_id:"",order_no:"",merchant_id:[],order_type:[],purse_type_id:[],user_type_id:[],pay_status:[],notify_status:[],refund_status:[],payment:[],date:[]},pay_status:["未支付","支付成功"],notify_status:["未通知","通知成功"],refund_status:["未退款","退款成功"]}},methods:{search:function(t){this.keyword.page=t,this.keyword.export=0,this.init()},exports:function(){this.keyword.export=1,this.init()},complete:function(t){var e=this;mdui.confirm("手动标记为支付成功并分发通知，是否收到款项需财务核实，点击【确定】继续","三方支付漏单/掉单补回",function(){e.$API.post("/order/complete",{id:t}).then(function(t){mdui.alert("操作完成，订单标记为已支付",function(){},{history:!1}),e.init()}).catch(function(t){})},function(){},{history:!1,confirmText:"确定",cancelText:"取消"})},notify:function(t){var e=this;mdui.confirm("异步通知会影响商户对支付的响应，可能造成多次结算等问题，知悉后点击【确定】继续","手动发起异步通知",function(){e.$API.post("/order/notify",{id:t}).then(function(t){mdui.alert("已重新分发通知任务",function(){},{history:!1}),e.init()}).catch(function(t){})},function(){},{history:!1,confirmText:"确定",cancelText:"取消"})},refund:function(t,e){var s=this;mdui.prompt("退款金额会返还到下单用户的现金钱包余额中，请在下方输入【退款金额】。注意：输入单位为分","订单总金额(分)："+e,function(e){e&&s.$API.post("/order/refund",{id:t,amount:e}).then(function(t){mdui.alert("退款成功，已完成系统到用户的转账操作，如产生奖励部分需手动冲正",function(){},{history:!1}),s.init()}).catch(function(t){})},function(){},{history:!1,confirmText:"确定",cancelText:"取消"})},init:function(){var t=this;t.$API.get("/order/index",t.keyword).then(function(e){t.list=e.list,t.merchant=e.merchant,t.purse_type=e.purse_type,t.user_type=e.user_type,t.order_type=e.order_type,t.payment=e.payment,t.payments=e.payments,t.amount_sum=e.amount_sum,t.keyword.export&&mdui.alert("可在左侧【导出任务】菜单查看任务状态并下载文件","已放入导出任务",function(){},{history:!1})}).catch(function(t){})}},mounted:function(){this.init()}}},360:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order_index"},[s("div",{staticClass:"typo",on:{keydown:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.search(1)}}},[s("blockquote",{staticClass:"blockquote_normal"},[s("p",[t._v("\n\t\t\t\t订单号："),s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.order_no,expression:"keyword.order_no"}],staticClass:"mdui-textfield-input input_normal",attrs:{type:"text"},domProps:{value:t.keyword.order_no},on:{input:function(e){e.target.composing||t.$set(t.keyword,"order_no",e.target.value)}}})]),t._v(" "),s("p",[t._v("\n\t\t\t\t下单用户ID："),s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.user_id,expression:"keyword.user_id"}],staticClass:"mdui-textfield-input input_normal",attrs:{type:"text"},domProps:{value:t.keyword.user_id},on:{input:function(e){e.target.composing||t.$set(t.keyword,"user_id",e.target.value)}}})]),t._v(" "),s("p",[t._v("\n\t\t\t\t日期筛选："),s("date-picker",{model:{value:t.keyword.date,callback:function(e){t.$set(t.keyword,"date",e)},expression:"keyword.date"}})],1),s("p",[t._v("\n\t\t\t\t商　　户：\n\t\t\t\t"),t._l(t.merchant,function(e,r){return s("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.merchant_id,expression:"keyword.merchant_id"}],attrs:{type:"checkbox"},domProps:{value:r,checked:Array.isArray(t.keyword.merchant_id)?t._i(t.keyword.merchant_id,r)>-1:t.keyword.merchant_id},on:{change:function(e){var s=t.keyword.merchant_id,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=r,i=t._i(s,o);a.checked?i<0&&t.$set(t.keyword,"merchant_id",s.concat([o])):i>-1&&t.$set(t.keyword,"merchant_id",s.slice(0,i).concat(s.slice(i+1)))}else t.$set(t.keyword,"merchant_id",n)}}}),t._v(" "),s("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])})],2),t._v(" "),s("p",[t._v("\n\t\t\t\t订单类型：\n\t\t\t\t"),t._l(t.order_type,function(e,r){return s("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.order_type,expression:"keyword.order_type"}],attrs:{type:"checkbox"},domProps:{value:e,checked:Array.isArray(t.keyword.order_type)?t._i(t.keyword.order_type,e)>-1:t.keyword.order_type},on:{change:function(s){var r=t.keyword.order_type,a=s.target,n=!!a.checked;if(Array.isArray(r)){var o=e,i=t._i(r,o);a.checked?i<0&&t.$set(t.keyword,"order_type",r.concat([o])):i>-1&&t.$set(t.keyword,"order_type",r.slice(0,i).concat(r.slice(i+1)))}else t.$set(t.keyword,"order_type",n)}}}),t._v(" "),s("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])})],2),t._v(" "),s("p",[t._v("\n\t\t\t\t订单状态：\n\t\t\t\t"),t._l(t.pay_status,function(e,r){return s("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.pay_status,expression:"keyword.pay_status"}],attrs:{type:"checkbox"},domProps:{value:r,checked:Array.isArray(t.keyword.pay_status)?t._i(t.keyword.pay_status,r)>-1:t.keyword.pay_status},on:{change:function(e){var s=t.keyword.pay_status,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=r,i=t._i(s,o);a.checked?i<0&&t.$set(t.keyword,"pay_status",s.concat([o])):i>-1&&t.$set(t.keyword,"pay_status",s.slice(0,i).concat(s.slice(i+1)))}else t.$set(t.keyword,"pay_status",n)}}}),t._v(" "),s("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])}),t._v(" "),t._l(t.notify_status,function(e,r){return s("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.notify_status,expression:"keyword.notify_status"}],attrs:{type:"checkbox"},domProps:{value:r,checked:Array.isArray(t.keyword.notify_status)?t._i(t.keyword.notify_status,r)>-1:t.keyword.notify_status},on:{change:function(e){var s=t.keyword.notify_status,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=r,i=t._i(s,o);a.checked?i<0&&t.$set(t.keyword,"notify_status",s.concat([o])):i>-1&&t.$set(t.keyword,"notify_status",s.slice(0,i).concat(s.slice(i+1)))}else t.$set(t.keyword,"notify_status",n)}}}),t._v(" "),s("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])}),t._v(" "),t._l(t.refund_status,function(e,r){return s("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.refund_status,expression:"keyword.refund_status"}],attrs:{type:"checkbox"},domProps:{value:r,checked:Array.isArray(t.keyword.refund_status)?t._i(t.keyword.refund_status,r)>-1:t.keyword.refund_status},on:{change:function(e){var s=t.keyword.refund_status,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=r,i=t._i(s,o);a.checked?i<0&&t.$set(t.keyword,"refund_status",s.concat([o])):i>-1&&t.$set(t.keyword,"refund_status",s.slice(0,i).concat(s.slice(i+1)))}else t.$set(t.keyword,"refund_status",n)}}}),t._v(" "),s("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t")])})],2),t._v(" "),s("p",[t._v("\n\t\t\t\t支付类型：\n\t\t\t\t"),t._l(t.payment,function(e,r){return s("label",{staticClass:"mdui-checkbox",staticStyle:{"margin-right":"2rem"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword.payment,expression:"keyword.payment"}],attrs:{type:"checkbox"},domProps:{value:e,checked:Array.isArray(t.keyword.payment)?t._i(t.keyword.payment,e)>-1:t.keyword.payment},on:{change:function(s){var r=t.keyword.payment,a=s.target,n=!!a.checked;if(Array.isArray(r)){var o=e,i=t._i(r,o);a.checked?i<0&&t.$set(t.keyword,"payment",r.concat([o])):i>-1&&t.$set(t.keyword,"payment",r.slice(0,i).concat(r.slice(i+1)))}else t.$set(t.keyword,"payment",n)}}}),t._v(" "),s("i",{staticClass:"mdui-checkbox-icon"}),t._v("\n\t\t\t\t\t"+t._s(t.payments[e]||e)+"\n\t\t\t\t")])})],2),t._v(" "),s("a",{staticClass:"mdui-btn mdui-ripple mdui-color-theme",on:{click:function(e){t.search(1)}}},[s("i",{staticClass:"mdui-icon mdui-icon-left material-icons"},[t._v("search")]),t._v("搜索")]),t._v(" "),s("a",{staticClass:"mdui-btn mdui-ripple mdui-color-pink",on:{click:t.exports}},[s("i",{staticClass:"mdui-icon mdui-icon-left material-icons"},[t._v("file_upload")]),t._v("导出")])]),t._v(" "),s("blockquote",{staticClass:"blockquote_normal"},[t._v("\n\t\t\t支付金额统计(分)\n\t\t\t"),s("p",{staticStyle:{"line-height":"25px"}},t._l(t.amount_sum,function(e,r){return s("span",{staticClass:"mdui-m-r-3"},[t._v(t._s(t.payments[r]||r)+"："+t._s(e))])}),0)])]),t._v(" "),s("div",{staticClass:"mdui-table-fluid"},[s("table",{staticClass:"mdui-table mdui-table-hoverable"},[t._l(t.list.data,function(e,r,a){return[s("tbody",[s("tr",{staticClass:"mdui-color-grey-200"},[s("td",[t._v("订单金额(分)："),s("span",{staticStyle:{color:"#FE0016"},domProps:{textContent:t._s(e.amount)}})]),t._v(" "),s("td",[t._v("订单号："),s("span",{staticStyle:{color:"#FF6A00"},domProps:{textContent:t._s(e.order_no)}})]),t._v(" "),s("td",[t._v("商品名："),s("span",{staticStyle:{color:"#169320"},domProps:{textContent:t._s(e.product_name)}})])]),t._v(" "),s("tr",[s("td",[t._v("下单用户ID："),s("span",{domProps:{textContent:t._s(e.user_id)}})]),t._v(" "),s("td",[t._v("同步返回地址："),s("span",{domProps:{textContent:t._s(e.return_url)}})]),t._v(" "),s("td",[t._v("异步通知地址："),s("span",{domProps:{textContent:t._s(e.notify_url)}})])]),t._v(" "),s("tr",[s("td",[t._v("订单状态："),s("strong",[e.status?s("span",{staticClass:"mdui-text-color-green"},[t._v("订单有效")]):s("span",{staticClass:"mdui-text-color-grey"},[t._v("订单无效")])])]),t._v(" "),s("td",[t._v("下单时间："),s("span",{domProps:{textContent:t._s(e.created_at)}})]),t._v(" "),s("td",[t._v("下单商户："),s("span",{domProps:{textContent:t._s(t.merchant[e.merchant_id])}})])]),t._v(" "),s("tr",[s("td",[t._v("支付状态："),s("strong",[e.pay_status?s("span",{staticClass:"mdui-text-color-green"},[t._v("支付成功")]):s("span",{staticClass:"mdui-text-color-grey"},[t._v("未支付")])])]),t._v(" "),s("td",[t._v("支付时间："),s("span",{domProps:{textContent:t._s(e.pay_time)}})]),t._v(" "),s("td",t._l(e.payment,function(r,a){return s("span",[s("span",{staticClass:"mdui-text-color-teal-400"},[t._v(t._s(t.payments[r.type]||r.type))]),t._v(" "),s("span",{staticClass:"mdui-text-color-red-500"},[t._v("「"+t._s(r.amount)+"」")]),a+1<e.payment.length?s("span",[t._v("、")]):t._e()])}),0)]),t._v(" "),s("tr",[s("td",[t._v("通知状态："),s("strong",[e.notify_status?s("span",{staticClass:"mdui-text-color-green"},[t._v("通知成功")]):s("span",{staticClass:"mdui-text-color-grey"},[t._v("未通知")])])]),t._v(" "),s("td",[t._v("通知时间："),s("span",{domProps:{textContent:t._s(e.notify_time)}})]),t._v(" "),s("td",[t._v("备注："),s("span",{domProps:{textContent:t._s(e.remarks)}})])]),t._v(" "),s("tr",[s("td",[t._v("退款状态："),s("strong",[e.refund_status?s("span",{staticClass:"mdui-text-color-red-500"},[t._v("已退款")]):s("span",{staticClass:"mdui-text-color-grey"},[t._v("未退款")])])]),t._v(" "),s("td",[t._v("退款时间："),s("span",{domProps:{textContent:t._s(e.refund_time)}})]),t._v(" "),s("td",[1==e.status&&0==e.pay_status?s("a",{staticClass:"mdui-btn mdui-ripple mdui-color-blue-grey",on:{click:function(s){t.complete(e.id)}}},[t._v("掉单补回")]):t._e(),t._v(" "),1==e.status&&1==e.pay_status&&0==e.refund_status?s("a",{staticClass:"mdui-btn mdui-ripple mdui-color-theme",on:{click:function(s){t.notify(e.id)}}},[t._v("手动通知")]):t._e(),t._v(" "),1==e.status&&1==e.pay_status&&0==e.refund_status?s("a",{staticClass:"mdui-btn mdui-ripple mdui-color-red",on:{click:function(s){t.refund(e.id,e.amount)}}},[t._v("订单退款")]):t._e()])])])]})],2)]),t._v(" "),s("div",{staticClass:"mdui-color-white footer"},[s("pagination",{attrs:{pageInfo:{total:t.list.total,current:t.list.current_page,pagenum:t.list.per_page,page:t.list.last_page,pagegroup:9,skin:"#2196F3"}},on:{change:t.search}})],1)])},staticRenderFns:[]}},389:function(t,e,s){var r=s(1)(s(359),s(360),!1,null,null,null);t.exports=r.exports}});